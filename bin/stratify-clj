#!/usr/bin/env bb
;; -*- clojure -*-
;; vim: set filetype=clojure:
(ns stratify
  (:require
   [babashka.classpath :as cp]
   [babashka.deps :as deps]
   [babashka.fs :as fs]
   [clojure.edn :as edn]))

(def project-path (-> (fs/real-path *file*) fs/parent fs/parent str))

(System/setProperty "stratify.project-path" project-path)

(let [bb-deps (edn/read-string (slurp (str project-path "/resources/io/github/dundalek/stratify/bb-deps.edn")))]
  (deps/add-deps (select-keys bb-deps [:deps]))
  (doseq [path (:paths bb-deps)]
    (cp/add-classpath (str project-path "/" path))))

(require '[stratify.main-bb :as main-bb])

(main-bb/delegate-to-jvm project-path *command-line-args*)
